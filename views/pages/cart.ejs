<!--panier - user page-->
<!DOCTYPE html>
<html lang="fr">
<%- include('../partials/head') %>
<head>
    <link rel="stylesheet" href="/css/popup.css">
    <script type="text/javascript" src="/js/popup.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.0.272/jspdf.debug.js"></script>
</head>
<body>

<%- include('../partials/user_navbar') %>

<div class="wrapper">
    <div class="center">
        <div class="title">Votre panier contient les √©l√©ments ci-dessous:</div>
        <!-- Liste des commandes-->
        <table id="commande" class=tableau>
            <tr>
                <!-- <th>Cat√©gorie du produit</th> -->
                <th>Produit</th>
                <th>Quantit√©</th>
                <th>Date sortie</th>
                <th>Date retour</th>

            </tr>
            <% if (cart !== undefined ) { %>
                <% for(element in cart) { %>
                    <tr>
                        <td><%= cart[element]["name"] %></td>
                        <td><%= cart[element]["quantity"] %></td>
                        <td><%= cart[element]["start_date"] %></td>
                        <td><%= cart[element]["end_date"] %></td>
                        <td>
                            <form action="/remove_from_cart" method="post">
                                <input type="hidden" name="product" value="<%= element %>">
                                <button>üóëÔ∏è</button>
                            </form>
                        </td>
                    </tr>
            <% } } %>
        </table>
        <button class="log" onclick="generatePDF()">Gen√©rer un re√ßu</button>
        <button class="log" onclick="toggle_popup()">Confirmer la commande</button>
        
    </div>

    <div id="popup" class="popup_div">
        <div class="center">
            <div class="main">
                <button class="popup_close" onclick="toggle_popup()"><span aria-hidden="true">&times;</span></button>
                <div class="signup">
                    <form action="/new_order" onsubmit="generatePDF();" id="user_info_form" method="post">
                        <label class="title_label">Veuillez remplir les champs ci-dessous:</label>
                        <input class="in" type="text" name="name" placeholder="Nom complet" required>
                        <input class="in" type="text" name="email" placeholder="Adresse mail" required>
                        <input class="in" type="text" name="phone_number" placeholder="GSM sous la forme +32" required>
                        <input class="in" type="text" name="address" placeholder="Adresse complete" required>
                        <button class="log" >Soumettre</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

</div>
<script>

    function generatePDF() {
        var pdf = new jsPDF
        pdf.text("LOUEvain-Li-Nux", 20, 20);
        pdf.text("kot: louvain linux", 20, 30);
        pdf.text("La  commande que vous avez pass√© contient les √©l√©ments suivants:", 20, 50);
        var table = document.getElementById('commande');

        for (var i = 0; i < table.rows.length; i++) {
            let b = 0

        for (var j = 0; j < table.rows[i].cells.length; j++) {
            var cellContent = table.rows[i].cells[j].innerHTML;

            pdf.text(cellContent + " :", 10, 70+(b*10));
            b += 1;
        }
        }
        pdf.save('re√ßu.pdf');
    }
</script>
</body>
</html>   